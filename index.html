<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Neon Game (Light/Dark)</title>

  <style>
    :root {
      /* Dark default */
      --bg: #050505;
      --panel: rgba(255,255,255,0.06);
      --text: #ffffff;
      --muted: rgba(255,255,255,0.70);
      --accent: #38bdf8;
      --danger: #fb7185;
      --canvas-bg: #000000;
      --border: rgba(56,189,248,0.7);
      --shadow: rgba(56,189,248,0.3);
    }

    /* Light theme overrides */
    [data-theme="light"] {
      --bg: #f7f8fb;
      --panel: rgba(0,0,0,0.06);
      --text: #0f172a;
      --muted: rgba(15,23,42,0.65);
      --accent: #0284c7;
      --danger: #e11d48;
      --canvas-bg: #ffffff;
      --border: rgba(2,132,199,0.55);
      --shadow: rgba(2,132,199,0.25);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: radial-gradient(900px 600px at 60% 15%, rgba(56,189,248,0.15), transparent 55%),
                  radial-gradient(850px 550px at 20% 80%, rgba(251,113,133,0.10), transparent 55%),
                  var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, "Inter", "Noto Sans KR", Arial, sans-serif;
      gap: 12px;
    }

    .info {
      width: min(720px, 92vw);
      padding: 14px 16px;
      border-radius: 16px;
      background: var(--panel);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.10);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .left {
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-width: 0;
    }

    #score {
      font-size: 20px;
      font-weight: 800;
      color: var(--accent);
      letter-spacing: 0.2px;
    }

    .sub {
      font-size: 12.5px;
      color: var(--muted);
      line-height: 1.35;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .right {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-shrink: 0;
    }

    .btn {
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.10);
      color: var(--text);
      padding: 9px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 12.5px;
      font-weight: 650;
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
      user-select: none;
    }
    [data-theme="light"] .btn {
      background: rgba(255,255,255,0.55);
      border-color: rgba(15,23,42,0.12);
    }
    .btn:hover { border-color: rgba(255,255,255,0.30); }
    [data-theme="light"] .btn:hover { border-color: rgba(15,23,42,0.22); }
    .btn:active { transform: translateY(1px); }

    .pill {
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      color: var(--muted);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    [data-theme="light"] .pill { border-color: rgba(15,23,42,0.12); }

    .dot {
      width: 8px; height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 12px var(--shadow);
    }

    canvas {
      width: min(720px, 92vw);
      height: calc(min(720px, 92vw) * 0.62);
      max-height: 72vh;
      border: 2px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 0 22px var(--shadow);
      background: var(--canvas-bg);
    }

    .hint {
      width: min(720px, 92vw);
      font-size: 12px;
      color: var(--muted);
      text-align: center;
      line-height: 1.3;
    }

    kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.18);
      color: var(--text);
    }
    [data-theme="light"] kbd {
      border-color: rgba(15,23,42,0.16);
      background: rgba(255,255,255,0.65);
      color: var(--text);
    }
  </style>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-16X2VD2MBB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-16X2VD2MBB');
  </script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "v2q1yt4o6w");
    </script>
</head>

<body data-theme="dark">
  <div class="info">
    <div class="left">
      <div id="score">SCORE: 0</div>
      <div class="sub">
        ì´ë™: ë§ˆìš°ìŠ¤ í´ë¦­
        Â· ì¼ì‹œì •ì§€: <kbd>Space</kbd>
        Â· ì¬ì‹œì‘: <kbd>R</kbd>
        Â· í…Œë§ˆ: <kbd>T</kbd>
      </div>
    </div>
    <div class="right">
      <span class="pill"><span class="dot"></span><span id="statusText">RUNNING</span></span>
      <button class="btn" id="themeBtn">ğŸŒ™ Dark</button>
      <button class="btn" id="restartBtn">Restart</button>
      <a href="contact.html" class="btn">ë¬¸ì˜í•˜ê¸°</a>
    </div>
  </div>

  <canvas id="gameCanvas" width="720" height="450"></canvas>
  <div class="hint">
    ëª©í‘œ(í•‘í¬)ë¥¼ ë¨¹ìœ¼ë©´ ì ìˆ˜ê°€ ì˜¤ë¥´ê³  ì†ë„ê°€ ì¦ê°€í•©ë‹ˆë‹¤. ì§§ì€ ì‹œê°„ ì•ˆì— ì—°ì†ìœ¼ë¡œ ë¨¹ìœ¼ë©´ ì½¤ë³´ ë³´ë„ˆìŠ¤ê°€ ìˆìŠµë‹ˆë‹¤.
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreElement = document.getElementById('score');
    const themeBtn = document.getElementById('themeBtn');
    const restartBtn = document.getElementById('restartBtn');
    const statusText = document.getElementById('statusText');

    const root = document.body;

    // ---------- Utilities ----------
    const rand = (a, b) => a + Math.random() * (b - a);
    const dist = (x1, y1, x2, y2) => Math.hypot(x1 - x2, y1 - y2);

    // ---------- Game state ----------
    let score = 0;
    let paused = false;

    canvas.addEventListener('click', (e) => {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const clickX = (e.clientX - rect.left) * scaleX;
      const clickY = (e.clientY - rect.top) * scaleY;

      const d = dist(clickX, clickY, target.x, target.y);
      if (d < target.size) {
        const now = performance.now();
        const withinCombo = (now - lastEatTime) < 1200; // 1.2s
        combo = withinCombo ? combo + 1 : 1;
        lastEatTime = now;

        const bonus = Math.min(1 + (combo - 1) * 0.35, 2.4); // up to 2.4x
        const add = Math.round(10 * bonus);
        score += add;

        // difficulty
        player.speed += 14; // px/s ì¦ê°€

        updateScoreText();

        // effects
        spawnParticles(target.x, target.y, target.color(), 22);
        shake = Math.min(shake + 8, 18);

        placeTargetSafe();
      }
    });

    window.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        togglePause();
      }
      if (e.code === 'KeyR') restart();
      if (e.code === 'KeyT') toggleTheme();
    });

    const player = {
      x: canvas.width / 2,
      y: canvas.height / 2,
      size: 22,
      speed: 260, // px/s (time-based)
      color: () => getCssVar('--accent'),
    };

    const target = {
      x: 0, y: 0,
      size: 9,
      color: () => getCssVar('--danger'),
      pulse: 0
    };

    // combo
    let combo = 0;
    let lastEatTime = 0; // ms

    // screen shake
    let shake = 0;

    // particles
    const particles = [];
    function spawnParticles(x, y, baseColor, count = 18) {
      for (let i = 0; i < count; i++) {
        particles.push({
          x, y,
          vx: rand(-180, 180),
          vy: rand(-180, 180),
          r: rand(1.5, 4),
          life: rand(0.4, 0.9),
          t: 0,
          color: baseColor
        });
      }
    }

    function getCssVar(name) {
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }

    function placeTargetSafe() {
      const margin = 28;
      let tx, ty;
      let tries = 0;
      do {
        tx = rand(margin, canvas.width - margin);
        ty = rand(margin, canvas.height - margin);
        tries++;
        if (tries > 100) break;
      } while (dist(tx, ty, player.x + player.size/2, player.y + player.size/2) < 120);
      target.x = tx;
      target.y = ty;
    }

    // ---------- Theme ----------
    function toggleTheme() {
      const current = root.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);

      themeBtn.textContent = next === 'dark' ? 'ğŸŒ™ Dark' : 'â˜€ï¸ Light';

      // reset background alpha based on theme (ì”ìƒ ì •ë„)
      trailAlpha = next === 'dark' ? 0.20 : 0.14;
    }

    // ---------- Pause / Restart ----------
    function togglePause() {
      paused = !paused;
      statusText.textContent = paused ? 'PAUSED' : 'RUNNING';
    }

    function restart() {
      score = 0;
      combo = 0;
      player.x = canvas.width / 2;
      player.y = canvas.height / 2;
      player.speed = 260;
      particles.length = 0;
      shake = 0;
      lastEatTime = 0;
      paused = false;
      statusText.textContent = 'RUNNING';
      updateScoreText();
      placeTargetSafe();
    }

    restartBtn.addEventListener('click', restart);
    themeBtn.addEventListener('click', toggleTheme);

    // ---------- Rendering settings ----------
    let trailAlpha = 0.20; // ì”ìƒ ì •ë„
    function clearWithTrail() {
      ctx.fillStyle = `rgba(0, 0, 0, ${trailAlpha})`;

      // ë¼ì´íŠ¸ í…Œë§ˆì¼ ë•Œ ì”ìƒ ë°°ê²½ì´ ê²€ê²Œ ë‚¨ëŠ” ê²Œ ì‹«ìœ¼ë©´ "ìº”ë²„ìŠ¤ ë°°ê²½ìƒ‰"ì— ë§ì¶”ê¸°:
      // ì•„ë˜ì²˜ëŸ¼ í˜„ì¬ canvas backgroundê°€ í°ìƒ‰ì¼ ë•ŒëŠ” í°ìƒ‰ ì”ìƒ ì‚¬ìš©
      const theme = root.getAttribute('data-theme');
      if (theme === 'light') {
        ctx.fillStyle = `rgba(255, 255, 255, ${trailAlpha})`;
      }
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    // ---------- Game Loop (time-based) ----------
    let last = performance.now();

    function update(dt) {
      // dt in seconds
      // Player is stationary

      // target pulse
      target.pulse += dt * 6;

      // particles update
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.t += dt;
        p.x += p.vx * dt;
        p.y += p.vy * dt;
        p.vx *= 0.94;
        p.vy *= 0.94;

        if (p.t >= p.life) particles.splice(i, 1);
      }

      // shake decay
      shake *= 0.90;
    }

    function updateScoreText() {
      const comboText = combo >= 2 ? `  (COMBO x${combo})` : '';
      scoreElement.textContent = `SCORE: ${score}${comboText}`;
    }

    function draw() {
      // screen shake
      const sx = (Math.random() - 0.5) * shake;
      const sy = (Math.random() - 0.5) * shake;

      ctx.save();
      ctx.translate(sx, sy);

      clearWithTrail();

      // target (glow + pulse)
      const pulse = 1 + Math.sin(target.pulse) * 0.12;
      ctx.shadowBlur = 18;
      ctx.shadowColor = target.color();
      ctx.fillStyle = target.color();
      ctx.beginPath();
      ctx.arc(target.x, target.y, target.size * pulse, 0, Math.PI * 2);
      ctx.fill();

      // particles
      for (const p of particles) {
        const a = 1 - (p.t / p.life);
        ctx.shadowBlur = 12;
        ctx.shadowColor = p.color;
        ctx.globalAlpha = a;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;

      // player
      // ctx.shadowBlur = 16;
      // ctx.shadowColor = player.color();
      // ctx.fillStyle = player.color();
      // ctx.fillRect(player.x, player.y, player.size, player.size);

      // pause overlay
      if (paused) {
        ctx.shadowBlur = 0;
        ctx.fillStyle = 'rgba(0,0,0,0.35)';
        if (root.getAttribute('data-theme') === 'light') {
          ctx.fillStyle = 'rgba(255,255,255,0.55)';
        }
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = root.getAttribute('data-theme') === 'light' ? '#0f172a' : '#ffffff';
        ctx.font = '700 34px ui-sans-serif, system-ui, -apple-system, "Noto Sans KR"';
        ctx.textAlign = 'center';
        ctx.fillText('PAUSED', canvas.w_idth/2, canvas.height/2 - 10);

        ctx.font = '500 14px ui-sans-serif, system-ui, -apple-system, "Noto Sans KR"';
        ctx.fillStyle = root.getAttribute('data-theme') === 'light' ? 'rgba(15,23,42,0.75)' : 'rgba(255,255,255,0.75)';
        ctx.fillText('Press SPACE to resume', canvas.width/2, canvas.height/2 + 20);
      }

      ctx.restore();
      ctx.shadowBlur = 0;
      ctx.globalAlpha = 1;
    }

    function loop(now) {
      const dt = (now - last) / 1000;
      last = now;

      if (!paused) update(Math.min(dt, 0.05));
      draw();

      requestAnimationFrame(loop);
    }

    // start
    toggleTheme(); // lightë¡œ ì‹œì‘í•˜ê³  ì‹¶ìœ¼ë©´ ì´ ì¤„ì„ í™œì„±í™”/ë¹„í™œì„±í™”ë¡œ ì¡°ì ˆ
    // ìœ„ ì¤„ì„ ì¼œë‘ë©´ ì²« ë¡œë“œì—ì„œ lightë¡œ ì „í™˜ë¨. dark ì‹œì‘ì´ë©´ ìœ„ ì¤„ì„ ì§€ìš°ì„¸ìš”.

    restart();
    requestAnimationFrame(loop);
  </script>
</body>
</html>